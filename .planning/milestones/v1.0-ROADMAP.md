# Milestone v1.0: Working Feedback Loop

**Status:** SHIPPED 2026-01-09
**Phases:** 1-3
**Total Plans:** 5

## Overview

The goal was a complete describe-render-analyze-listen-iterate workflow. After this milestone, you can describe sounds to Claude, have them rendered and analyzed, listen, provide feedback, and iterate.

## Phases

### Phase 1: Render Pipeline

**Goal:** Execute SuperCollider code and capture rendered audio
**Depends on:** None
**Plans:** 1 plan

Plans:
- [x] 01-01: Complete render pipeline (CLI entry point, dual render modes, error handling)

**Details:**
- `audioloop` CLI entry point (Python/typer)
- `audioloop render <file.scd>` command with two modes:
  - Full NRT mode (for complex sounds with custom timing)
  - Simple function wrapping mode (for quick iteration with `--duration`)
- `__OUTPUT_PATH__` placeholder convention
- SC code execution via sclang subprocess (NRT mode)
- WAV file capture and validation
- Error handling for SC compilation/runtime failures
- JSON output for Claude parsing

**Technical Challenges Resolved:**
- sclang subprocess management (exit behavior, compilation errors)
- macOS path handling (sclang in app bundle)
- Headless operation (QT_QPA_PLATFORM=offscreen on Linux only)

---

### Phase 2: Analysis Core

**Goal:** Extract acoustic features Claude can reason about
**Depends on:** Phase 1 (render pipeline provides WAV files)
**Plans:** 2 plans

Plans:
- [x] 02-01: Core analysis module (librosa feature extraction)
- [x] 02-02: CLI integration (interpret.py, analyze command)

**Details:**
- `audioloop analyze <file.wav>` command
- librosa-based feature extraction:
  - Spectral (per-channel L/R): centroid, rolloff, flatness, bandwidth
  - Temporal: RMS, crest factor, attack time
  - Stereo: width, L-R correlation, per-channel deltas
- Structured JSON output matching PROJECT.md schema
- Human-readable output with summary interpretation

**Key Decisions:**
- Mean aggregation for spectral features (single summary value)
- Mono channel duplication to L/R (consistent API)
- Reference ranges, not judgments (context-dependent interpretation)

---

### Phase 3: Iteration Tools

**Goal:** Complete the loop with playback and comparison
**Depends on:** Phase 2 (analyze provides features for comparison)
**Plans:** 2 plans

Plans:
- [x] 03-01: Play command (afplay wrapper)
- [x] 03-02: Compare command (feature delta analysis)

**Details:**
- `audioloop play <file.wav>` - system audio playback (afplay on macOS)
- `audioloop compare <a.wav> <b.wav>` - feature-by-feature delta analysis
- Comparison output optimized for Claude interpretation:
  - Direction indicators (up/down/unchanged)
  - Significance flags (>10% change)
  - Interpretive context ("darker/warmer", "snappier attack")
- Delta highlighting for iteration feedback

**Key Decisions:**
- >10% significance threshold (filters noise)
- Flat key structure for deltas (spectral.left.centroid_hz)
- Interpretation layer for semantic context

---

## Milestone Summary

**Key Decisions:**
- Two render modes: full NRT (user controls everything) and wrapped (quick iteration)
- Mode detection via recordNRT presence in source
- __OUTPUT_PATH__ placeholder convention for output path injection
- Exit codes: 0=success, 1=SC error, 2=system error
- Mean aggregation for spectral features
- Reference ranges, not hardcoded judgments
- >10% significance threshold for comparison deltas

**Issues Resolved:**
- Output path resolution (relative paths failed with sclang cwd)
- QT_QPA_PLATFORM only needed on Linux
- SC var declaration syntax requirements
- Rich console double-printing fix

**Issues Deferred:**
- Psychoacoustic metrics (Milestone 2)
- Spectrogram visualization (Milestone 3)

**Technical Debt Incurred:**
- None significant

---

_For current project status, see .planning/ROADMAP.md_
